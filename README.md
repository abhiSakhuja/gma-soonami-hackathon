# Semantic Search Flow - Hackathon

This document describes the flow of how a user query is processed, filtered, and searched across our system using semantic search and fine-tuned models.  This feature has been processed for the soonami hackathon, all the features described here and been incorporated during this time.

# High Level Design
![Architecture Diagram](./images/GMA_High_Level_Design.jpg)

# User Query Flow Design (AI for Hackathon)
![User Query Flow Design](./images/flow.png)

---

## üîÑ End-to-End Flow

### 1. User Query
The system receives:
- A **query** (e.g., ‚Äúfind the best Italian restaurants in Valencia, open now‚Äù)  
- Original **filters** (optional, such as location, price range, etc.)  

---

### 2. Query Processing (Parallel Agents)
The query is paraphrased and analyzed by three parallel extraction modules:

- **Type Extraction** ‚Üí Identifies cuisine or business type (e.g., "Italian", "restaurant").  
- **Location Extraction** ‚Üí Extracts city or neighborhood, checked against the **Locations DB**.  
- **Filters Extraction** ‚Üí Extracts additional constraints (e.g., "open now", "cheap", "family friendly").  

---

### 3. Filters Update
The extracted type, location, and filters are merged to form a structured query representation.  

---

### 4. Initial Record Retrieval
A **Lambda service** retrieves an initial set of candidate record IDs from **DynamoDB**.  

---

### 5. Semantic Search
The retrieved IDs are matched **semantically** using **Pinecone (to be replaced by OpenSearch)**  (via another Lambda service).  
- This step uses a **fine-tuned embedding model**, trained on our in-house dataset, to compute similarity.  

---

### 6. Reranking & Explanation
The candidate results are:  
1. **Reranked** based on semantic relevance.  
2. Enriched with a **reason for the match**, generated by an **LLM**.  

---

### 7. Final Results
The system returns the final ranked list of results (chunks) to the user.  

---

## üìå Components Overview
- **Locations DB** ‚Üí Stores cities, regions, and location references.  
- **DynamoDB** ‚Üí Stores record metadata and IDs.  
- **Lambda Services** ‚Üí Orchestrate DynamoDB retrieval and Pinecone (to be replaced by OpenSearch) search.  
- **Pinecone** ‚Üí Vector database for semantic similarity search (to be replaced by OpenSearch)
- **Fine-tuned Model** ‚Üí Embedding model trained on our dataset for domain-specific semantic matching.  
- **LLM** ‚Üí Provides final reranking and reasoning for transparency.  
