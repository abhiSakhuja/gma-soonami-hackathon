# Semantic Search Flow - Hackathon

This document describes the flow of how a user query is processed, filtered, and searched across our system using semantic search and fine-tuned models.  This feature has been processed for the soonami hackathon, all the features described here and been incorporated during this time.

# High Level Design
![Architecture Diagram](./images/GMA_High_Level_Design.jpg)

# User Query Flow Design (AI for Hackathon)
![User Query Flow Design](./images/flow.png)

---

## ğŸ”„ End-to-End Flow

### 1. User Query
The system receives:
- A **query** (e.g., â€œfind the best Italian restaurants in Valencia, open nowâ€)  
- Original **filters** (optional, such as location, price range, etc.)  

---

### 2. Query Processing (Parallel Agents)
The query is paraphrased and analyzed by three parallel extraction modules:

- **Type Extraction** â†’ Identifies cuisine or business type (e.g., "Italian", "restaurant").  
- **Location Extraction** â†’ Extracts city or neighborhood, checked against the **Locations DB**.  
- **Filters Extraction** â†’ Extracts additional constraints (e.g., "open now", "cheap", "family friendly").  

---

### 3. Filters Update
The extracted type, location, and filters are merged to form a structured query representation.  

---

### 4. Initial Record Retrieval
A **Lambda service** retrieves an initial set of candidate record IDs from **DynamoDB**.  

---

### 5. Semantic Search
The retrieved IDs are matched **semantically** using **Pinecone** (via another Lambda service).  
- This step uses a **fine-tuned embedding model**, trained on our in-house dataset, to compute similarity.  

---

### 6. Reranking & Explanation
The candidate results are:  
1. **Reranked** based on semantic relevance.  
2. Enriched with a **reason for the match**, generated by an **LLM**.  

---

### 7. Final Results
The system returns the final ranked list of results (chunks) to the user.  

---

## ğŸ“Œ Components Overview
- **Locations DB** â†’ Stores cities, regions, and location references.  
- **DynamoDB** â†’ Stores record metadata and IDs.  
- **Lambda Services** â†’ Orchestrate DynamoDB retrieval and Pinecone search.  
- **Pinecone** â†’ Vector database for semantic similarity search.  
- **Fine-tuned Model** â†’ Embedding model trained on our dataset for domain-specific semantic matching.  
- **LLM** â†’ Provides final reranking and reasoning for transparency.  
